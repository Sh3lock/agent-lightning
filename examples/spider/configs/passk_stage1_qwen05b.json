{
  "algorithm": {
    "adv_estimator": "grpo_passk_seed",
    "passk_k": 4,
    "passk_mode": "analytic",
    "passk_bootstrap_B": 1024,
    "passk_bootstrap_with_replacement": false,
    "passk_bootstrap_count_multiplicity": true,
    "passk_norm_by_std": true,
    "passk_adv_scale_factor": 1.0,
    "passk_debug_assert_full_group": false,
    "use_kl_in_reward": false
  },
  "data": {
    "train_files": "data/train_spider.parquet",
    "val_files": "data/test_dev.parquet",
    "train_batch_size": 48,
    "max_prompt_length": 4096,
    "max_response_length": 2048,
    "truncation": "error"
  },
  "actor_rollout_ref": {
    "rollout": {
      "tensor_model_parallel_size": 1,
      "n": 16,
      "log_prob_micro_batch_size_per_gpu": 48,
      "multi_turn": { "format": "hermes" },
      "name": "vllm",
      "gpu_memory_utilization": 0.6,
      "engine_kwargs": {
        "vllm": {
          "enable_auto_tool_choice": true,
          "tool_call_parser": "hermes"
        }
      }
    },
    "actor": {
      "ppo_mini_batch_size": 48,
      "ppo_micro_batch_size_per_gpu": 6,
      "optim": { "lr": 2e-6 },
      "use_kl_loss": false,
      "kl_loss_coef": 0.0,
      "entropy_coeff": 0,
      "clip_ratio_low": 0.2,
      "clip_ratio_high": 0.3,
      "fsdp_config": {
        "param_offload": false,
        "optimizer_offload": false
      }
    },
    "ref": {
      "log_prob_micro_batch_size_per_gpu": 48,
      "fsdp_config": { "param_offload": false }
    },
    "model": {
      "path": "/root/autodl-tmp/Qwen2.5-Coder-0.5B-Instruct",
      "use_remove_padding": true,
      "enable_gradient_checkpointing": true
    }
  },  
  "trainer": {
    "n_gpus_per_node": 1,
    "val_before_train": false,
    "critic_warmup": 0,
    "logger": ["console", "wandb"],
    "project_name": "AgentLightning",
    "experiment_name": "spider_passk_stage1",
    "nnodes": 1,
    "test_freq": 5,
    "total_epochs": 1,
    "log_interval": 1,
    "save_freq": 15,
    "default_local_dir": "/root/verl_pass/ckpt_passk_stage1"
  }
}
